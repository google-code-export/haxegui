<?xml version="1.0" encoding="iso-8859-1"?>
<haxegui:Layout name="Example4">

    <haxegui:Window name="Step Sequencer" x="100" y="40" width="460" height="400" sizeable="true" color="0x666666">

	<haxegui:MenuBar name="menubar" width="512" x="10" y="20" />
	<haxegui:ScrollPane name="ScrollPane1" x="10" y="44" >
		<haxegui:Container name="Container1" width="512" height="512" color="0x666666" >

		<haxegui:controls:Button name="Start" label="Start" x="20" y="20" width="60" color="0x666666" />
		<haxegui:controls:Button name="Stop" label="Stop" x="90" y="20" width="60" color="0x666666" />
		<haxegui:controls:Stepper name="Stepper1" x="170" y="28" value="120" step="1" min="1" max="300" color="0x666666"/>
		<haxegui:controls:Stepper name="Stepper2" x="250" y="28" disabled="true" min="1" max="16" color="0x666666"/>

		<events>
			<script type="text/hscript" action="onLoaded">
			trace("Window loaded" + Std.string(here));
			</script>
		</events>
		<!--
		<script type="text/hscript">

		    var window = root.getChildByName("Step Sequencer");
		    var scrollpane = window.getChildByName("ScrollPane1");
		    var container = scrollpane.content.getChildByName("Container1");


		    var BPM_TO_MS = 60*250;

		    var start = container.getChildByName("Start");
		    var stop = container.getChildByName("Stop");

		    var step1 = container.getChildByName("Stepper1");
		    var step2 = container.getChildByName("Stepper2");


		    for(i in 1...16)
			{
			    var radio = new haxegui.controls.RadioButton(container, "RadioButton"+i, 24*i, 70);
			    radio.init();
			    radio.color =  0x666666;
			    radio.removeChild(radio.label);
			    radio.redraw();
			}



		    function update()
			{
			    step2.value ++ ;
			    if(step2.value > 15) step2.value = 1;
			    step2.onChanged();
			    
			    var rb = container.getChildByName("RadioButton"+step2.value);
			    rb.color = 0xff0000;
			    rb.redraw();
			    rb.color =  0x666666;
			    Timer.delay( rb.redraw, BPM_TO_MS / step1.value );

		
			    for(i in 0...9)
			    {
			    var chkbox = container.getChildByName("CheckBox_"+i+"_"+step2.value);
			    if(chkbox!=null) 
				{
				var s = container.getChildByName("tick"+i);
				s.graphics.lineStyle(2, 0x4D4D4D);
				s.graphics.beginFill(chkbox.checked ? 0x7DFF00 : 0x666666 );
				s.graphics.drawRect(0,0,10,20);
				s.graphics.endFill();
				}
			    }


			}

		    var t = new haxe.Timer( BPM_TO_MS / step1.value );
		    t.run = update;
		    t.stop();
		    
		    step1.addEventListener( flash.events.Event.CHANGE,
			function(e)
			{
			    step2.value = 1;
			    for(i in 1...16)
			    {
				var rb = container.getChildByName("RadioButton"+i);
				rb.color = 0x666666;
				rb.redraw();
				rb.on = false;
			    }
			    t.stop();
			    t = new haxe.Timer( BPM_TO_MS / step1.value );
			    t.run = update;
			});

		    
		    start.addEventListener( flash.events.MouseEvent.MOUSE_UP, function(e){ t.stop(); t = new haxe.Timer( BPM_TO_MS / step1.value ); t.run = update; });
		    stop.addEventListener ( flash.events.MouseEvent.MOUSE_UP, function(e){ t.stop(); });

		    for(i in 0...9)
		    {
			for(j in 1...16)
			{
			    var chkbox = new haxegui.controls.CheckBox(container, "CheckBox_"+i+"_"+j, 24*j, 100 + 24*i);
			    chkbox.init();
			    chkbox.removeChild(chkbox.label);
			    chkbox.color = (j==1 || j%5==0) ? 0x999999 : 0x666666;
			    chkbox.redraw();
			}
			var s = new flash.display.Sprite();
			s.name = "tick" + i;
			s.graphics.lineStyle(2, 0x4D4D4D);
			s.graphics.beginFill(0x666666);
			s.graphics.drawRect(0,0,10,20);
			s.graphics.endFill();
			s.x = 400;
			s.y = 100+ 24*i;
			container.addChild(s);
		    }

		</script>
		-->
		</haxegui:Container>
	</haxegui:ScrollPane>
    </haxegui:Window>
</haxegui:Layout>
